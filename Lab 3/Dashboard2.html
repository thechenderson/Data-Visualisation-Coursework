<!--
Author: Christohper Henderson
Project: Data Visualisation and Analytics Lab 3
Date: 14/03/22
URL: https://github.com/thechenderson/Data-Visualisation-Coursework
-->

<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Vaccine Dashboard 2</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src='https://d3js.org/d3.v7.min.js'></script>
    </head>
    <body>

        <!--Vaccinations data can be found here:
        https://github.com/owid/covid-19-data/tree/master/public/data/vaccinations
        -->

        <button onclick="drawGraph(data1)">Dataset 1</button>
        <button onclick="drawGraph(data2)">Dataset 2</button>
        <button onclick="drawGraph(data3)">Dataset 3</button>
        
        
        <script>

            //The vaccinations dataset location
            const vaccinationsCSV = 'https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/vaccinations/vaccinations.csv';

            //Set the dimensions and margins of the graph
            const margin = {top: 30, right: 30, bottom: 70, left: 80};
            const width = window.innerWidth - margin.left - margin.right;
            const height = 600 - margin.top - margin.bottom;

                

            //Append the svg object to the body of the page
            var svg = d3.select('body')
                .append('div')
            .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform",
                "translate(" + margin.left + "," + margin.top + ")");

           



            //Function to draw the graph onto the svg using the selected dataset
            function drawGraph(data) {

                //Filter the data to UK
                data = d3.filter(data, function(d){
                    if(d.location == "United Kingdom"){
                        return d
                    }
                })

                //Set the maximum and minimum sizes for the axes
                const xExtent = d3.extent(data, function(d){
                    return d.date
                })
            
                const yExtent = d3.extent(data, function(d){
                    return d.total_vaccinations
                })
                
                //Create the axes
                const xScale = d3.scaleTime()
                    .domain([xExtent[0], xExtent[1]])
                    .range([0, width])

                const yScale = d3.scaleLinear()
                    .domain([yExtent[0], yExtent[1]])
                    .range([0, height])

                   

                svg.append("g")
                    .attr("transform", "translate(0,"+height+")")
                    .call(d3.axisBottom(xScale))

                svg.append("g")
                    .call(d3.axisLeft(yScale))

                    
                svg.append('path')
                    .datum(data)
                    .attr("stroke", "black")
                    .attr("stroke-width", 1.5)
                    .attr("d", d3.line()
                        .x(function(d){
                            return x(d.date)
                        })
                        .y(function(d){
                            return x(d.total_vaccinations)
                        })
                    )
            }

                d3.csv(vaccinationsCSV)
                    .then(data1 => drawGraph(data1))

        </script>
    </body>
</html>